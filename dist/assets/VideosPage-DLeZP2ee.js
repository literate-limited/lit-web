import{a as F,r as i,j as e}from"./index-D0UK4MyN.js";import{v as o}from"./api-Ch0e_-9b.js";function C(){const{refreshCredits:p}=F(),[u,j]=i.useState([]),[y,v]=i.useState(!0),[h,m]=i.useState(!1),[r,x]=i.useState({}),[f,a]=i.useState(null),[g,c]=i.useState(null);i.useEffect(()=>{n()},[]);const n=async()=>{try{v(!0);const t=await o.list();j(t.videos||[])}catch(t){console.error("Failed to load videos:",t),a("Failed to load videos")}finally{v(!1)}},N=async t=>{var s;const l=(s=t.target.files)==null?void 0:s[0];if(l)try{m(!0),a(null),c(null);const d=await o.upload(l);c(`Video "${d.video.title}" uploaded successfully!`),n(),p(),t.target.value=""}catch(d){console.error("Upload failed:",d),a(d.message||"Failed to upload video")}finally{m(!1)}},b=async t=>{var l;try{x({...r,[t]:!0}),a(null);const s=await o.transcribe(t);c(`Video transcribed successfully! Charged ${s.creditsCharged} credits.`),n(),p()}catch(s){console.error("Transcription failed:",s),(l=s.message)!=null&&l.includes("INSUFFICIENT_CREDITS")?a("Insufficient credits. Please purchase more credits to transcribe this video."):a(s.message||"Failed to transcribe video")}finally{x({...r,[t]:!1})}},S=async t=>{if(confirm("Are you sure you want to delete this video?"))try{await o.delete(t),c("Video deleted successfully"),n()}catch(l){console.error("Delete failed:",l),a("Failed to delete video")}};return y?e.jsx("div",{className:"ttv-page",children:e.jsx("div",{className:"ttv-loading",children:e.jsx("div",{className:"ttv-spinner"})})}):e.jsxs("div",{className:"ttv-page",children:[e.jsxs("div",{className:"ttv-page-header",children:[e.jsx("h1",{className:"ttv-page-title",children:"Videos"}),e.jsx("p",{className:"ttv-page-subtitle",children:"Upload and manage your videos"})]}),f&&e.jsx("div",{className:"ttv-alert ttv-alert-error",children:f}),g&&e.jsx("div",{className:"ttv-alert ttv-alert-success",children:g}),e.jsxs("div",{className:"ttv-card",children:[e.jsx("h2",{className:"ttv-card-title",children:"Upload Video"}),e.jsxs("div",{className:"ttv-form-group",children:[e.jsx("label",{className:"ttv-label",children:"Select Video File (max 500MB)"}),e.jsx("input",{type:"file",accept:"video/*",onChange:N,disabled:h,className:"ttv-input",style:{padding:"12px"}}),h&&e.jsx("div",{style:{marginTop:"12px",color:"#10B981"},children:"Uploading video..."})]})]}),u.length===0?e.jsx("div",{className:"ttv-card",children:e.jsxs("div",{className:"ttv-empty-state",children:[e.jsx("div",{className:"ttv-empty-icon",children:"ðŸŽ¬"}),e.jsx("p",{className:"ttv-empty-title",children:"No videos yet"}),e.jsx("p",{className:"ttv-empty-description",children:"Upload your first video to get started"})]})}):e.jsxs("div",{className:"ttv-card",children:[e.jsxs("h2",{className:"ttv-card-title",children:["All Videos (",u.length,")"]}),e.jsx("ul",{className:"ttv-list",children:u.map(t=>e.jsx("li",{className:"ttv-list-item",children:e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 8px",color:"#F1F5F9"},children:t.title}),e.jsxs("div",{style:{fontSize:"14px",color:"#94A3B8",marginBottom:"12px"},children:[t.duration_seconds?`Duration: ${Math.round(t.duration_seconds)}s`:"Duration unknown"," ","â€¢"," ",t.file_size_bytes?`Size: ${(t.file_size_bytes/1024/1024).toFixed(2)}MB`:"Size unknown"," ","â€¢"," ","Uploaded ",new Date(t.created_at).toLocaleDateString()]}),e.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.jsx("button",{className:"ttv-button",onClick:()=>b(t.id),disabled:r[t.id],children:r[t.id]?"Transcribing...":"ðŸŽ™ï¸ Transcribe"}),e.jsx("button",{className:"ttv-button ttv-button-danger",onClick:()=>S(t.id),children:"Delete"})]})]})},t.id))})]})]})}export{C as default};
